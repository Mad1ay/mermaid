# UC-FR6.1.1: Управління профілем клієнта

## Загальна інформація

- **ID:** UC-FR6.1.1
- **Назва:** Управління профілем клієнта
- **Актори:** Внутрішній адміністратор, Адміністратор рецепції
- **Тип:** Use Case

## Опис

Створення, пошук, перегляд та редагування профілів клієнтів, які містять персональні дані, контактну інформацію та фінансові баланси. Процес забезпечує централізоване управління інформацією про клієнтів з дотриманням унікальності ключових даних та валідацією введених значень.

## Передумови

- Актор авторизований у системі з відповідними правами
- Система управління клієнтами функціонує
- База даних клієнтів доступна

## Основні сценарії

### 1. Створення нового клієнта

**Послідовність дій:**

1. Актор ініціює операцію створення нового клієнта
2. Система відображає форму для введення даних
3. Актор заповнює обов'язкові та додаткові поля:
   - ПІБ (Прізвище, Ім'я, По батькові)
   - Номер телефону
   - Email (опціонально)
   - Дата народження
   - Номер картки/браслета
   - Інші контактні дані
4. Система перевіряє формат введених даних:
   - Коректність email
   - Формат номера телефону
   - Валідність дати народження
5. Якщо формат даних неправильний:
   - Система відображає повідомлення про помилку
   - Надає підказку щодо правильного формату
   - Актор виправляє дані
6. Система перевіряє унікальність:
   - Номера картки/браслета
   - Номера телефону
7. Якщо виявлено дублікат:
   - Система блокує створення профілю
   - Повідомляє про існування клієнта з такими даними
   - Пропонує переглянути існуючий профіль
8. Якщо всі перевірки пройдені успішно:
   - Актор зберігає профіль
   - Система створює новий запис у базі даних
   - Присвоює унікальний ідентифікатор клієнта

### 2. Пошук існуючого клієнта

**Послідовність дій:**

1. Актор ініціює пошук клієнта
2. Система відображає форму пошуку з доступними критеріями:
   - ПІБ (повне або часткове)
   - Номер телефону
   - Номер картки/браслета
   - Email
3. Актор вводить критерії пошуку
4. Система виконує пошук у базі даних
5. **Якщо клієнт знайдений:**
   - Система відображає список знайдених профілів
   - Показує ключову інформацію для ідентифікації
   - Актор обирає потрібний профіль зі списку
   - Переходить до перегляду або редагування
6. **Якщо клієнт не знайдений:**
   - Система повідомляє, що клієнт із такими даними відсутній
   - Пропонує створити новий профіль

### 3. Перегляд профілю клієнта

**Послідовність дій:**

1. Актор обирає опцію "Перегляд" для знайденого профілю
2. Система відображає дані клієнта в режимі "тільки для читання"
3. Актор переглядає:
   - Персональні дані
   - Контактну інформацію
   - Баланси (депозит, бонуси)
   - Рівень лояльності
   - Історію відвідувань (посилання)
   - Статистику покупок

### 4. Редагування профілю клієнта

**Послідовність дій:**

1. Актор обирає опцію "Редагування" для знайденого профілю
2. Система відкриває форму редагування з поточними даними
3. Актор вносить зміни у дозволені поля:
   - Контактна інформація
   - Персональні дані
   - Номер картки (з обережністю)
4. Система перевіряє унікальність змінених даних:
   - Якщо змінено номер картки - перевірка унікальності
   - Якщо змінено телефон - перевірка унікальності
5. Якщо виявлено дублікат:
   - Система блокує збереження
   - Повідомляє про конфлікт
   - Актор виправляє дані
6. Актор зберігає зміни
7. Система оновлює профіль клієнта в базі даних
8. Фіксує дату та час останнього оновлення
9. Зберігає історію змін (audit log)

## Післяумови

- Профіль клієнта успішно створено або оновлено в системі
- Дані клієнта актуальні та доступні для використання
- Унікальність ключових полів дотримано
- Всі зміни зафіксовані в історії

## Альтернативні потоки

### Клієнта не знайдено під час пошуку

- Система повідомляє, що клієнт із такими даними відсутній
- Пропонує розширити критерії пошуку
- Або створити новий профіль

### Некоректні дані при введенні

- Система виявляє неправильний формат (email, телефон)
- Відображає повідомлення про помилку біля відповідного поля
- Надає підказку щодо правильного формату
- Блокує збереження до виправлення

### Дублікат номера картки або телефону

- Система виявляє, що такий номер вже існує
- Блокує операцію створення/оновлення
- Повідомляє про дублікат з зазначенням конфліктного поля
- Пропонує переглянути існуючий профіль
- Або змінити дані на унікальні

## Виняткові ситуації

### Втрата з'єднання з базою даних

- Система повідомляє про технічну помилку
- Рекомендує спробувати пізніше
- Не зберігає неповні дані

### Відсутність необхідних прав доступу

- Система перевіряє права перед кожною операцією
- Блокує недозволені дії
- Повідомляє про відсутність прав

### Конфлікт одночасного редагування

- Два користувачі редагують один профіль
- Система використовує оптимістичні блокування
- Попереджає про конфлікт при збереженні
- Пропонує переглянути актуальні дані та повторити

## Бізнес-правила

### Унікальність даних

- Номер картки/браслета повинен бути унікальним у системі
- Номер телефону повинен бути унікальним
- Email повинен бути унікальним (якщо вказано)

### Обов'язкові поля

- ПІБ (мінімум - Прізвище та Ім'я)
- Номер телефону АБО номер картки (мінімум одне)

### Формат даних

- Телефон: +380XXXXXXXXX або інший міжнародний формат
- Email: стандартний формат email
- Дата народження: не може бути у майбутньому

### Права доступу

- Адміністратор рецепції: створення, пошук, перегляд, обмежене редагування
- Внутрішній адміністратор: всі операції без обмежень

## Пов'язані Use Cases

- UC-FR6.1.2: Пошук та ідентифікація клієнта
- UC-FR6.1.5: Управління депозитним рахунком клієнта
- UC-FR6.1.6: Управління бонусною системою
- UC-FR6.1.10: Онлайн-особистий кабінет клієнта

## Інтеграції

- **База даних клієнтів:** Зберігання профілів
- **Система контролю доступу:** Управління картками/браслетами
- **Програма лояльності:** Синхронізація рівнів та балансів
- **Audit log:** Збереження історії змін

## Метрики успішності

- Час створення нового профілю (цільовий: < 2 хвилин)
- Швидкість пошуку клієнта (цільовий: < 3 секунд)
- Відсоток профілів із заповненими контактами (цільовий: > 95%)
- Кількість дублікатів (цільовий: 0)

## Приклади використання

### Реєстрація нового гостя

1. Гість приходить до рецепції вперше
2. Адміністратор створює профіль
3. Видає картку/браслет з унікальним номером
4. Клієнт готовий користуватися послугами

### Пошук постійного клієнта

1. Клієнт називає номер телефону
2. Адміністратор знаходить профіль за 2-3 секунди
3. Перевіряє актуальність даних
4. Продовжує обслуговування

### Оновлення контактів

1. Клієнт повідомляє про зміну телефону
2. Адміністратор знаходить профіль
3. Оновлює номер телефону
4. Система перевіряє унікальність та зберігає
